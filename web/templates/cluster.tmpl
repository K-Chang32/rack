{{ define "title" }} {{.Name}} {{ end }}

{{ define "body" }}
	<ul class="breadcrumb">
		<li><a href="/clusters">Clusters</a></li>
		<li class="active">{{.Name}}</li>
	</ul>
	<div class="panel panel-default">
		<div class="panel-heading">
			<form method="post" action="/clusters/{{.Name}}/delete">
				<input type="submit" class="btn btn-danger btn-xs" value="Destroy Cluster">
			</form>
			<h3 class="panel-title">Cluster Information</h3>
		</div>
		<div class="panel-body">
			Stuff
		</div>
	</div>
	<table class="table table-striped table-bordered">
		<thead>
			<tr class="title">
				<th colspan="5">
					<button class="btn btn-success btn-xs" data-toggle="modal" data-target="#app-create">Create App</button>
					Apps
				</th>
			</tr>
			<tr>
				<th class="expand">Name</th>
				<th>Status</th>
				<th>CPU</th>
				<th>RAM</th>
				<th>Disk</th>
			</tr>
		</thead>
		<tbody>
			{{ $cluster := . }}
			{{ range $app := .Apps }}
				<tr>
					<td><a href="/clusters/{{$cluster.Name}}/apps/{{.Name}}">{{.Name}}</a></td>
					<td>{{ .Status }}</td>
					<td>{{ meter "cpu"    .CpuUsed    .CpuTotal    }}</td>
					<td>{{ meter "memory" .MemoryUsed .MemoryTotal }}</td>
					<td>{{ meter "disk"   .DiskUsed   .DiskTotal   }}</td>
				</tr>
			{{ end }}
		</tbody>
	</table>
	{{ template "modals" . }}
{{ end }}

{{ define "modals" }}
	<div class="modal fade" id="app-create" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<form method="post" action="/clusters/{{.Name}}/apps" class="form-horizontal">
					<input type="hidden" name="cluster" value="{{.Name}}">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
						<h4 class="modal-title" id="myModalLabel">Create App</h4>
					</div>
					<div class="modal-body">
						<div class="form-group">
							<label for="app-name" class="col-sm-3 control-label">App Name</label>
							<div class="col-sm-8">
								<input name="name" type="text" class="form-control" id="app-name">
							</div>
						</div>
						<div class="form-group">
							<label for="app-repo" class="col-sm-3 control-label">Git Repository</label>
							<div class="col-sm-8">
								<input name="repo" type="text" class="form-control" id="app-repo" value="https://github.com/convox-examples/sinatra.git">
							</div>
						</div>
						<div class="form-group">
							<label for="cluster-size" class="col-sm-3 control-label">Instance Size</label>
							<div class="col-sm-4">
								<select name="size" class="form-control" id="cluster-size">
									<option>t2.micro</option>
								</select>
							</div>
						</div>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
						<input type="submit" class="btn btn-primary" value="Create App">
					</div>
				</form>
			</div>
		</div>
	</div>
{{ end }}
